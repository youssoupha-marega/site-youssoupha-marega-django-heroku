{% comment %}
Composant réutilisable pour afficher une carte de contenu (projet, blog, service).

Paramètres requis:
- item: L'objet de contenu (Project, BlogPost ou Service)
- detail_url: L'URL de la page détail
- button_text: Texte du bouton principal (ex: "Voir le projet", "Lire l'article")

Paramètres optionnels:
- show_image: Afficher l'image principale (défaut: True)
- show_author: Afficher les infos auteur (défaut: True)
- show_date: Afficher la date de publication (défaut: True)
- show_extra_button: Afficher un bouton supplémentaire (défaut: False)
- extra_button_url: URL du bouton supplémentaire
- extra_button_text: Texte du bouton supplémentaire
- truncate_words: Nombre de mots pour truncatewords (défaut: 20)

Exemples d'utilisation:

1. Carte de projet:
{% include 'includes/content_card.html' with item=projet detail_url=projet_detail_url button_text="Voir le projet" %}

2. Carte de blog:
{% include 'includes/content_card.html' with item=article detail_url=article_detail_url button_text="Lire l'article" %}

3. Carte de service avec bouton Calendly:
{% include 'includes/content_card.html' with item=service detail_url=service_detail_url button_text="En savoir plus" show_extra_button=True extra_button_url=service.calendly_url extra_button_text="Prendre rendez-vous" %}
{% endcomment %}

{% load static %}

<div class="card portfolio-card" style="transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); animation: fadeIn 0.6s ease-out backwards;">
    <div class="card-body" style="position: relative;">
        {# Badge ou catégorie si disponible #}
        {% if item.category or item.tags %}
        <div class="mb-3" style="display: flex; gap: 6px; flex-wrap: wrap;">
            {% if item.category %}
            <span class="badge" style="background: rgba(44, 82, 130, 0.08); color: #2c5282; border: 1px solid rgba(44, 82, 130, 0.2); padding: 4px 12px; border-radius: 8px; font-weight: 600; font-size: 0.75rem;">
                {{ item.category }}
            </span>
            {% endif %}
        </div>
        {% endif %}
        
        {# Titre de la carte avec hover subtil #}
        <h3 class="card-title h5 mb-3" style="font-weight: 700; color: #1a202c; transition: color 0.3s ease;" 
            onmouseover="this.style.color='#2c5282';" 
            onmouseout="this.style.color='#1a202c';">
            {{ item.title }}
        </h3>
        
        {# Image principale avec effet subtil au survol #}
        {% if show_image|default:True and item.main_image %}
        <div class="card-media mb-3" style="position: relative; overflow: hidden; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
            <img src="{{ item.main_image.url }}" 
                 alt="{{ item.title }}" 
                 class="img-fluid" 
                 style="border-radius: 12px; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); display: block; width: 100%;"
                 onmouseover="this.style.transform='scale(1.03)'" 
                 onmouseout="this.style.transform='scale(1)'">
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44, 82, 130, 0.03); opacity: 0; transition: opacity 0.3s ease; border-radius: 12px; pointer-events: none;" 
                 onmouseover="this.style.opacity='1'" 
                 onmouseout="this.style.opacity='0'"></div>
        </div>
        {% endif %}
        
        {# Métadonnées: auteur et date avec icônes modernes #}
        {% if show_author or show_date or show_update_date %}
        <div class="mb-3 meta-info-group">
            {% if show_author %}
            <div class="meta-info-item meta-author">
                <i class="fas fa-user-circle" style="color: #2c5282;"></i>
                <a href="mailto:{{ item.author_email }}" style="color: #2c5282; text-decoration: none; font-weight: 600; transition: color 0.3s ease;"
                   onmouseover="this.style.textDecoration='underline'" 
                   onmouseout="this.style.textDecoration='none';">
                    {{ item.author_name }}
                </a>
            </div>
            {% if show_author_profession and item.author_profession %}
            <div class="meta-info-item meta-profession">
                <span>{{ item.author_profession }}</span>
            </div>
            {% endif %}
            {% endif %}
            {% if show_date and item.published_at %}
            <div class="meta-info-item meta-date">
                <i class="fas fa-calendar-alt" style="color: #2c5282;"></i>
                <span>{{ item.published_at|date:"d M Y" }}</span>
            </div>
            {% endif %}
            {% if show_update_date and item.updated_at %}
            <div class="meta-info-item meta-date">
                <i class="fas fa-sync-alt" style="color: #2c5282;"></i>
                <span>{{ item.updated_at|date:"d M Y" }}</span>
            </div>
            {% endif %}
        </div>
        {% endif %}
        
        {# Résumé du contenu avec hauteur fixe #}
        {% if item.resume %}
        <p class="card-text mb-4" style="color: var(--text-secondary, #64748b); line-height: 1.7; min-height: 60px;">
            {% if truncate_words %}
                {{ item.resume|safe }}
            {% else %}
                {{ item.resume|safe }}
            {% endif %}
        </p>
        {% endif %}
        
        {# Boutons d'action harmonieux #}
        <div class="d-flex gap-2 flex-wrap mt-auto">
            {# Bouton supplémentaire (ex: Calendly pour services) #}
            {% if show_extra_button and extra_button_url %}
            <a href="{{ extra_button_url }}" 
               {% if extra_button_target %}target="{{ extra_button_target }}"{% endif %}
               class="btn btn-custom-primary btn-sm"
               style="display: inline-flex; align-items: center; gap: 6px; padding: 0.55rem 1.1rem; font-size: 0.9rem; border-radius: 10px;">
                <i class="fas fa-calendar-check" style="font-size: 0.85rem;"></i>
                {{ extra_button_text|default:"Action" }}
            </a>
            {% endif %}
            
            {# Bouton principal de détail #}
            <a href="{{ detail_url }}" 
               class="btn {% if show_extra_button %}btn-custom-outline{% else %}btn-custom-primary{% endif %} btn-sm"
               style="display: inline-flex; align-items: center; gap: 6px; padding: 0.55rem 1.1rem; font-size: 0.9rem; border-radius: 10px;">
                {{ button_text|default:"En savoir plus" }}
                <i class="fas fa-arrow-right" style="font-size: 0.8rem;"></i>
            </a>
        </div>
    </div>
</div>
